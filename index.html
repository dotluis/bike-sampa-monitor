<!DOCTYPE html>
<html>
<head>
    <title>Monitoramento Bike Sampa</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->    
</head>
<body>

    <h1>Gráfico de uso de hoje</h1>
    <div id="chart"></div>
    <h1>Lista de estações</h1>
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th><strong>Estação</strong></th>
                <th>Bicicletas</th>
                <th>Capacidade</th>
                <th>Nome</th>
                <th>Endereço</th>
                <th>Status</th>
            </tr>   
        </thead>
        <tbody>
            {% for estacao in estacoes %}
                <tr class="
                    {% if estacao.funcionando and estacao.bicicletas == 0 %}warning{% endif %}
                    {% if estacao.funcionando and estacao.bicicletas > 0 %}success{% endif %}
                    {% if not estacao.funcionando %}danger{% endif %}                    
                    ">
                    <td align="right"><strong>{{estacao.numero}}</strong></td>
                    <td>{{estacao.bicicletas}}</td>
                    <td>{{estacao.vagas}}</td>
                    <td>{{estacao.nome}}</td>
                    <td>{{estacao.endereco}}</td>
                    <td>{{estacao.status}}</td>
                </tr>
            {%- endfor %}            
        </tbody>
    </table>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>    
    <script type="text/javascript">
        google.load("visualization", "1.1", {packages:["line"]});
        google.setOnLoadCallback(draw);

        function draw(){
            var data = new google.visualization.arrayToDataTable([
                ['Estação', 'Usos', 'Bicicletas'],
                {% for estacao in estacoes %}
                    {% if estacao.funcionando %}
                        [{{estacao.numero}}, {{estacao.interacoes}}, {{estacao.bicicletas}}],
                    {%- endif %}
                {%- endfor %}
            ]);
            var options = {
                width: window.innerWidth*.9,
                height: window.innerHeight*.7,
                //bars: 'horizontal',
                /*series:{
                    0: {axis: 'usos'},
                    1: {axis: 'bicicletas'},
                },
                axes: {
                    y:{
                        usos:{label: 'Usos'},
                        bicicletas:{side:'right', label:'Bicicletas'},
                    }
                }*/
            };
            var chart = new google.charts.Line(document.getElementById('chart'));
            chart.draw(data, options);
        }
    </script>
</body>
<html>